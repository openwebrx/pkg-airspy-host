From a3c66d73d4b9d962066b0cc2814fc43567a2171a Mon Sep 17 00:00:00 2001
From: martinzsmith <martin_z_smith@yahoo.ie>
Date: Sat, 26 Sep 2015 14:09:36 +0100
Subject: [PATCH 05/10] fix for repeat of usage message x19

https://github.com/airspy/host/issues/25
---
 airspy-tools/src/airspy_si5351c.c | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)

diff --git a/airspy-tools/src/airspy_si5351c.c b/airspy-tools/src/airspy_si5351c.c
index 4d32afd..ae8efb4 100644
--- a/airspy-tools/src/airspy_si5351c.c
+++ b/airspy-tools/src/airspy_si5351c.c
@@ -51,6 +51,7 @@ static struct option long_options[] = {
 	{ "register", required_argument, 0, 'n' },
 	{ "write", required_argument, 0, 'w' },
 	{ "read", no_argument, 0, 'r' },
+	{ "serial", required_argument, 0, 's' },
 	{ 0, 0, 0, 0 },
 };
 
@@ -273,7 +274,7 @@ int main(int argc, char** argv) {
 	result = AIRSPY_ERROR_OTHER;
 	option_index = 0;
 	optind = 0;
-	while( (opt = getopt_long(argc, argv, "cn:rw:", long_options, &option_index)) != EOF ) {
+	while( (opt = getopt_long(argc, argv, "cn:rw:s:", long_options, &option_index)) != EOF ) {
 		switch( opt ) {
 		case 'n':
 			result = parse_int(optarg, &register_number);
@@ -296,9 +297,12 @@ int main(int argc, char** argv) {
 			break;
 		
 		case 'c':
-			dump_configuration(device);
+			result = dump_configuration(device);
+			break;
+		case 's':
+			serial_number = true;
+			result = parse_u64(optarg, &serial_number_val);
 			break;
-
 		default:
 			usage();
 		}
-- 
2.1.4

